{% extends 'base.html' %}
{% block title %}Dashboard - Almoxarifado{% endblock %}

{% block content %}
<div class="container">
  <!-- Seção de Boas-Vindas -->
  <div class="row mb-4">
    <div class="col">
      <h1 class="display-4">Bem-vindo ao Sistema de Almoxarifado</h1>
      <p class="lead">Visão geral e métricas do sistema.</p>
    </div>
  </div>

  <!-- Cartões de Estatísticas (clicáveis) -->
  <div class="row">
    <div class="col-md-3 mb-3">
      <a href="/produtos" class="text-decoration-none">
        <div class="card text-white bg-info h-100">
          <div class="card-body">
            <h5 class="card-title">Total de Produtos</h5>
            <p class="card-text fs-4">{{ total_produtos }}</p>
          </div>
        </div>
      </a>
    </div>
    <div class="col-md-3 mb-3">
      <a href="/movimentacoes" class="text-decoration-none">
        <div class="card text-white bg-success h-100">
          <div class="card-body">
            <h5 class="card-title">Movimentações Recentes</h5>
            <p class="card-text fs-4">{{ total_movimentacoes }}</p>
          </div>
        </div>
      </a>
    </div>
    <div class="col-md-3 mb-3">
      <!-- Caso tenha uma página para gerenciar usuários ativos, ajuste o link -->
      <a href="/usuarios" class="text-decoration-none">
        <div class="card text-white bg-danger h-100">
          <div class="card-body">
            <h5 class="card-title">Usuários Ativos</h5>
            <p class="card-text fs-4">{{ total_usuarios }}</p>
          </div>
        </div>
      </a>
    </div>
  </div>

  <!-- Últimas Movimentações -->
  <div class="row mt-4">
    <div class="col">
      <h2>Últimas Movimentações</h2>
      <div class="table-responsive">
        <table class="table table-striped table-bordered">
          <thead class="table-dark">
            <tr>
              <th>Data</th>
              <th>Produto</th>
              <th>Quantidade</th>
              <th>Tipo</th>
            </tr>
          </thead>
          <tbody>
            {% for mov in ultimas_movimentacoes %}
            <tr class="clickable-row" data-href="/movimentacoes/{{ mov.id }}">
              <td>{{ mov.data }}</td>
              <td>{{ mov.produto }}</td>
              <td>{{ mov.quantidade }}</td>
              <td>{{ mov.tipo }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Script para tornar as linhas da tabela clicáveis -->
<script>
document.addEventListener("DOMContentLoaded", function() {
  const rows = document.querySelectorAll(".clickable-row");
  rows.forEach(row => {
    row.style.cursor = "pointer";
    row.addEventListener("click", function() {
      const href = row.getAttribute("data-href");
      if (href) {
        window.location.href = href;
      }
    });
  });
});
</script>
{% endblock %}
